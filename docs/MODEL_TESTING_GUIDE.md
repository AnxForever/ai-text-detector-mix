# 模型测试使用指南

> 如何测试你的AI文本检测模型
> 作者：AI文本检测项目组
> 日期：2026-01-11

---

## 一、快速开始

### 方式1：交互模式（推荐）

最简单的方式，逐个输入文本进行检测：

```bash
cd /mnt/c/datacollection
source .venv/bin/activate
export HF_HUB_OFFLINE=1  # 使用离线模式

python3 scripts/evaluation/test_single_text.py --interactive
```

**使用流程**：
1. 启动后会提示你输入文本
2. 输入或粘贴文本内容
3. 如果是多行文本，输入完后输入 `END` 结束
4. 查看检测结果
5. 继续输入下一个文本，或输入 `quit` 退出

**示例**：
```
请输入待检测文本（多行输入请以 END 结束）:
今天天气不错，我去公园散步了。
看到很多人在锻炼身体，心情很好。
END

======================================================================
检测结果
======================================================================

【待检测文本】
今天天气不错，我去公园散步了。
看到很多人在锻炼身体，心情很好。

文本长度: 36 字符

【预测结果】
判断: 人类撰写
置信度: 95.32%

【详细概率】
  人类撰写: 95.32%
  AI生成:   4.68%

【置信度解释】
  ✅ 非常确定 (>95%)
======================================================================
```

---

### 方式2：命令行单文本

直接在命令中指定文本：

```bash
python3 scripts/evaluation/test_single_text.py \
    --text "人工智能技术在近年来取得了巨大的发展，深度学习模型在图像识别、自然语言处理等领域都展现出了惊人的能力。"
```

---

### 方式3：批量测试文件

准备一个文本文件，每行一个待测文本：

```bash
# 1. 创建测试文件
cat > test_texts.txt << 'EOF'
今天天气不错，适合出去玩。
人工智能是计算机科学的一个分支，它致力于创建能够执行通常需要人类智能的任务的系统。
我昨天去了超市买菜，结果发现涨价了。
EOF

# 2. 批量检测
python3 scripts/evaluation/test_single_text.py --file test_texts.txt
```

---

## 二、AI生成测试文本的注意事项 ⚠️

### 关键注意事项

#### 1. **必须使用纯文本格式**

**❌ 错误示例（包含markdown）**：
```
# 人工智能的发展

人工智能技术包括：
- 机器学习
- 深度学习
- 自然语言处理

**重点**：AI正在改变世界
```

**✅ 正确示例（纯文本）**：
```
人工智能的发展非常迅速。人工智能技术包括机器学习、深度学习和自然语言处理等多个领域。这些技术正在深刻改变我们的世界，在医疗、教育、交通等多个行业都有广泛应用。
```

**为什么？**
- 我们的模型是在**去偏后的纯文本数据**上训练的
- 模型已经学会不依赖markdown格式判断
- 如果你给AI生成的文本包含markdown，模型仍能正确识别（对抗测试验证过）
- 但为了公平测试，建议使用纯文本

---

#### 2. **文本长度建议：300-600字**

**原因**：
- 训练数据主要是300-600字的中短文本
- 这个长度范围模型表现最稳定
- 太短（<100字）：信息不足，可能不确定
- 太长（>1000字）：可能超出模型学习范围

**生成提示词示例**：
```
请用300-400字纯文本（无格式）介绍一下人工智能的应用。
不要使用markdown、列表符号、加粗等格式，
只用自然段落组织内容。
```

---

#### 3. **避免明显的格式标记**

**需要避免的格式元素**：
- ❌ 标题：`# 标题`、`## 二级标题`
- ❌ 加粗：`**加粗文字**`
- ❌ 斜体：`*斜体*`、`_斜体_`
- ❌ 列表：`- 列表项`、`* 列表`、`1. 编号列表`
- ❌ 代码：`` `代码` ``、` ```代码块``` `
- ❌ 分割线：`---`、`***`
- ❌ 引用：`> 引用内容`
- ❌ 链接：`[链接](url)`

**如果AI生成时包含了这些，手动去除即可。**

---

#### 4. **主题选择**

**建议测试的主题**：

**A. 技术类**（AI倾向的领域）
```
主题：人工智能、机器学习、区块链、云计算等
预期：更容易被识别为AI生成
```

**B. 生活类**（人类倾向的领域）
```
主题：日常生活、个人经历、情感表达等
预期：可能更难识别（考验模型真实能力）
```

**C. 新闻类**（我们的人类文本来源）
```
主题：新闻报道、时事评论、社会现象等
预期：如果AI生成得像新闻，测试模型的区分能力
```

---

#### 5. **生成提示词建议**

**推荐的AI生成提示**：

**示例1：明确要求纯文本**
```
请用350字左右的纯文本介绍深度学习的基本概念。
要求：
1. 不使用任何markdown格式
2. 不使用列表符号
3. 使用自然段落组织
4. 像写普通文章一样
```

**示例2：模拟新闻风格**
```
请以新闻报道的风格，用400字介绍最近的AI技术进展。
纯文本，无格式，模仿新闻记者的写作风格。
```

**示例3：模拟人类口吻**
```
请用第一人称，像普通人聊天一样，
用300字谈谈你对人工智能的看法。
纯文本，口语化，自然表达。
```

---

## 三、测试策略建议

### 3.1 基础测试（验证模型工作）

**测试1：明显的AI文本**
```
生成一段技术性很强的AI介绍（350字）
预期：应该被识别为AI（置信度>90%）
```

**测试2：明显的人类文本**
```
复制一段真实的新闻报道（300-500字）
预期：应该被识别为人类（置信度>80%）
```

---

### 3.2 边界测试（挑战模型）

**测试3：AI模拟人类风格**
```
提示词：请用非常口语化、不那么正式的语言，
像一个普通人写日记一样，写一段300字的文字。

看模型能否仍然识别出这是AI生成的。
```

**测试4：格式干扰测试**
```
给AI生成的文本手动添加一些markdown格式，
看模型是否仍能正确识别（应该能，因为通过了对抗测试）
```

**测试5：长度边界**
```
生成100字的短文本
生成800字的长文本

看模型在不同长度下的表现
```

---

### 3.3 真实场景测试

**场景1：邮件内容**
```
让AI生成一封工作邮件（纯文本，300字）
测试模型在实际应用场景的表现
```

**场景2：摘要总结**
```
让AI对某篇文章写摘要（纯文本，200-400字）
```

**场景3：问答回复**
```
让AI回答一个技术问题（纯文本，300-500字）
```

---

## 四、结果解读

### 置信度含义

| 置信度 | 含义 | 建议 |
|--------|------|------|
| **>95%** | ✅ 非常确定 | 可以高度信任结果 |
| **80-95%** | ✅ 比较确定 | 结果可靠 |
| **60-80%** | ⚠️ 有一定把握 | 有一定不确定性 |
| **<60%** | ❓ 不太确定 | 建议人工复核 |

### 预期表现（基于我们的实验结果）

**去偏后模型的特点**：
- ✅ 对纯文本AI检测准确率：99.46%
- ✅ 对格式变化完全免疫（下降<0.1%）
- ✅ 不会因为markdown存在就判断为AI
- ✅ 真正基于语义特征判断

**可能出现的情况**：

1. **AI生成得非常"人类化"** → 可能被识别为人类
   - 这是正常的，说明AI进步了
   - 测试了模型的极限

2. **人类文本写得很"AI化"** → 可能被误判为AI
   - 例如：非常规范、逻辑严密、专业术语多
   - 这也是模型的正常表现

3. **置信度不高** → 说明文本处于边界
   - 可能是风格混合
   - 或者信息不足（太短）

---

## 五、完整示例

### 示例1：检测AI生成的技术文本

**生成提示**：
```
用350字纯文本（无格式）介绍机器学习的基本原理。
```

**AI生成的文本**（假设）：
```
机器学习是人工智能的核心技术之一，它使计算机能够从数据中学习模式并做出决策。机器学习的基本原理是通过算法分析大量数据，自动发现数据中的规律和模式。常见的机器学习方法包括监督学习、无监督学习和强化学习。监督学习使用标注数据训练模型，无监督学习则在无标注数据中发现结构，强化学习通过与环境交互来学习最优策略。深度学习是机器学习的一个重要分支，它使用多层神经网络来学习数据的深层表示。这些技术在图像识别、自然语言处理、推荐系统等领域都有广泛应用，正在深刻改变我们的生活和工作方式。
```

**运行检测**：
```bash
python3 scripts/evaluation/test_single_text.py --interactive
# 粘贴上述文本
# 输入 END
```

**预期结果**：
```
【预测结果】
判断: AI生成
置信度: 96.8%
```

---

### 示例2：检测人类撰写的新闻

**真实新闻片段**（假设来自新闻网站）：
```
昨日，某市举行了年度马拉松比赛，吸引了来自全国各地的三千余名选手参赛。比赛于清晨七点开始，选手们在市中心主干道起跑，沿途经过多个著名景点。虽然天气炎热，但选手们热情高涨，市民们也纷纷到场为选手加油助威。最终，来自本省的选手张某以两小时十五分的成绩夺得男子组冠军，女子组冠军则由外省选手李某获得。赛事组织方表示，本次马拉松不仅是一场体育盛事，更是展示城市形象、促进全民健身的重要活动。
```

**运行检测**：
```bash
python3 scripts/evaluation/test_single_text.py --text "昨日，某市举行了年度马拉松比赛..."
```

**预期结果**：
```
【预测结果】
判断: 人类撰写
置信度: 92.3%
```

---

## 六、常见问题

### Q1: 为什么要避免markdown格式？

**A**: 虽然我们的模型已经通过对抗测试，证明对格式变化免疫（下降<0.1%），但为了公平测试和符合训练数据分布，建议使用纯文本。训练数据是去偏后的纯文本，在相同条件下测试更准确。

### Q2: 文本太短会怎样？

**A**: 文本太短（<100字）时，模型可能没有足够的信息做出判断，置信度会降低。建议至少200字，最佳是300-600字。

### Q3: 如果AI生成时自动加了markdown怎么办？

**A**:
- 方法1：手动删除markdown符号
- 方法2：直接测试（模型应该仍能正确识别）
- 方法3：在提示词中明确要求"纯文本，无任何格式"

### Q4: 能检测中英文混合的文本吗？

**A**: 模型在纯中文上训练，对中英文混合的表现未知。建议测试纯中文文本。

### Q5: 置信度多高才算准确？

**A**: 根据我们的测试：
- >95%：非常可靠
- 80-95%：比较可靠
- 60-80%：有一定参考价值
- <60%：建议人工复核

---

## 七、进阶：自动化测试脚本

如果你想批量生成测试文本并自动检测，可以这样做：

```python
# test_automation.py
import openai  # 或你使用的AI API

# 1. 生成测试文本
test_cases = [
    "用350字纯文本介绍深度学习",
    "用300字纯文本描述春天的景色",
    "用400字纯文本讨论环保问题",
]

generated_texts = []
for prompt in test_cases:
    # 调用AI API生成文本
    response = openai.ChatCompletion.create(
        model="gpt-3.5-turbo",
        messages=[{"role": "user", "content": prompt}]
    )
    text = response.choices[0].message.content
    generated_texts.append(text)

# 2. 保存到文件
with open('generated_tests.txt', 'w', encoding='utf-8') as f:
    for text in generated_texts:
        f.write(text + '\n')

# 3. 批量检测
# python3 scripts/evaluation/test_single_text.py --file generated_tests.txt
```

---

## 八、快速命令参考

```bash
# 交互模式
python3 scripts/evaluation/test_single_text.py --interactive

# 单文本检测
python3 scripts/evaluation/test_single_text.py --text "你的文本"

# 批量文件检测
python3 scripts/evaluation/test_single_text.py --file test_texts.txt

# 使用CPU（如果没有GPU）
python3 scripts/evaluation/test_single_text.py --device cpu --interactive

# 指定其他模型路径
python3 scripts/evaluation/test_single_text.py \
    --model-dir models/your_model \
    --interactive
```

---

## 九、测试检查清单

测试前确认：
- [ ] 虚拟环境已激活（`source .venv/bin/activate`）
- [ ] 离线模式已设置（`export HF_HUB_OFFLINE=1`）
- [ ] 模型路径正确（默认：`models/bert_improved/best_model`）
- [ ] GPU可用（或准备使用CPU）

生成AI文本时确认：
- [ ] 使用纯文本格式（无markdown）
- [ ] 文本长度300-600字
- [ ] 明确告诉AI不要使用格式
- [ ] 检查生成的文本，手动删除格式标记

---

**祝测试顺利！有任何问题随时询问。** 🚀
